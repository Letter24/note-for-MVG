# 对极几何与基本矩阵

本章是重点章节

## 9.1 对极几何

对极几何是投影几何的内在性质, 反应的是两幅图像的关系.

它假设空间点X在图像1的投影是$x$, 图像2的投影是$x'$, 那么$x$和$x'$有啥关系?

可以明确的是, $x,x',X$三个点构成了一个平面, 叫极平面$\pi$. 如果我们把$x$反投影, 会形成一条$\pi$上的射线$l'$, $l'$往图像2上投影,$x'$一定会在$l'$上, $l'$就叫极线. 同时, 连接图像1的相机中心和图像2的相机中心, 这条线叫基线, 基线会和两个图像有交点, 叫极点. 图像2的极点$e'$也在$l'$上, 所以$x'$和$e'$构成了一条直线, 可以表达为
$$
[e']_{\times} x' = l'
$$

我们再考虑一下$x'$怎么用$x$表示? 很简单$x'=P'P^{+}x$, 就是把x用P的逆反投影回去, 再用P'投影一下. e'怎么用e表示,很简单:P'C, 看到这里有个问题, C为啥不是$P'P^{+}C$? 因为C本身不用P^{+}的逆去反投影,为啥呢?

因为如果我们把x反投影, 会形成一条射线,可以表示为
$$
X(\lambda) = P^{+}x + \lambda C
$$

$\lambda \rightarrow \infty$的时候, $X(\lambda)=C$, 所以我们看到C其实和P没啥关系的.

回到正题, 我们把x' e'的表达式带入l' 就得到了
$$
l'=(P'C) \times (P'P^{+}x) \\
=[e']_{\times} (P'P^{+})x \\
=Fx
$$
就得到了基本矩阵F的表达式.

然后x'在l'上, 所以 $x'^T l' = 0$, 这样就得到了
$$
x'^T F x=0
$$

下面我们总结一下$F$的性质
1. F 是一个$3 \times 3$的矩阵 rank=2, 有7个自由度, 所以$det F = 0$
2. $x, x'$是一对对应点, 那么$x'^T F x = 0$
3. $Fx$就是$x$对应极极线
4. 极点满足$Fe=0$, 所以解方程$Fx=0$就得到了极点. 另一个极点页满足$e'^TF = 0$

## 9.5 F的作用

本节我们讲述$F$的一个非常重要的用途, 就是恢复两个摄像机的矩阵

我们先说明一个结论
**结论9.8** 如果H是一个$4 \times 4$的投影变换矩阵, 那么$P,P'$的基本矩阵$F$, 与$PH,P'H$的基本矩阵$F$是一样的

另外还有一个结论
**结论9.9** 假设$P=[I|0],P'=[M|m]$, 那么$F$就是$[m]_{\times} M$

那么这么$M,m$具体长什么样子? 以下结论告诉我们

**结论9.14** $F$对应的两个相机矩阵可以写成$P=[I|0],P'=[[e']_{\times}F|e']$

## 9.6 本质矩阵
一句话概括, 本质矩阵就是对应点在图像坐标系下的对应关系. 假设我们知道内参, 那么$P=K[R|t]$, 所以$K^{-1} P=[R|t]$, 其中$K^{-1} P$叫归一化的相机矩阵. 那么点会怎么变化?

原来是$x=PX$, 现在$P$变成了$K^{-1} P$, 所以点就变成了$K^{-1}PX=K^{-1}x$, 我们把$K^{-1}x$记为$\hat{x}'$, 所以$K \hat{x}'=x$, 然后带入基本矩阵的表达式, 就得到了基本矩阵和本质矩阵的关系
$$
E=K'^T F K
$$

书上的思路是从$K^{-1} P$推导, 可以把$K^{-1} P$记成$\hat{P}$, 用$\hat{P}$把基本矩阵重新推一次, 也可以得到上述关系

$E$可以由旋转和平移得到, 表示为$E=[t]_{\times} R$

$E$有啥性质? 他也是一个$ 3 \times 3$的奇异矩阵,最后一行是0

$E$有啥用途? 我们可以从$E$种恢复摄像机矩阵, 假设$P=[I|0]$, 而且我们知道$E$, 把$E$做SVD分别$E=Udiag(1,1,0)V^T$, 那么$P'有四种不同结果, 这个在三维重建的时候有用.